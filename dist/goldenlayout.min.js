!function(a){var b={config:{},container:{},controls:{},errors:{},items:{},utils:{}};b.utils.F=function(){},b.utils.extend=function(a,c){a.prototype=b.utils.createObject(c.prototype),a.prototype.contructor=a},b.utils.createObject=function(a){return"function"==typeof Object.create?Object.create(a):(b.utils.F.prototype=a,new b.utils.F)},b.utils.objectKeys=function(a){var b,c;if("function"==typeof Object.keys)return Object.keys(a);b=[];for(c in a)b.push(c);return b},b.utils.getHashValue=function(a){var b=location.hash.match(new RegExp(a+"=([^&]*)"));return b?b[1]:null},b.utils.getQueryStringParam=function(a){if(window.location.hash)return b.utils.getHashValue(a);if(!window.location.search)return null;var e,f,c=window.location.search.substr(1).split("&"),d={};for(f=0;f<c.length;f++)e=c[f].split("="),d[e[0]]=e[1];return d[a]||null},b.utils.copy=function(a,b){for(var c in b)a[c]=b[c];return a},b.utils.animFrame=function(a){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)})(function(){a()})},b.utils.indexOf=function(a,b){if(!(b instanceof Array))throw new Error("Haystack is not an Array");if(b.indexOf)return b.indexOf(a);for(var c=0;c<b.length;c++)if(b[c]===a)return c;return-1},"function"!=typeof/./&&"object"!=typeof Int8Array?b.utils.isFunction=function(a){return"function"==typeof a||!1}:b.utils.isFunction=function(a){return"[object Function]"===toString.call(a)},b.utils.fnBind=function(a,b,c){if(void 0!==Function.prototype.bind)return Function.prototype.bind.apply(a,[b].concat(c||[]));var d=function(){var e=(c||[]).concat(Array.prototype.slice.call(arguments,0));return this instanceof d?void a.apply(this,e):a.apply(b,e)};return d.prototype=a.prototype,d},b.utils.removeFromArray=function(a,c){var d=b.utils.indexOf(a,c);if(d===-1)throw new Error("Can't remove item from array. Item is not in the array");c.splice(d,1)},b.utils.now=function(){return"function"==typeof Date.now?Date.now():(new Date).getTime()},b.utils.getUniqueId=function(){return(1e15*Math.random()).toString(36).replace(".","")},b.utils.filterXss=function(a,b){var c=a.replace(/javascript/gi,"j&#97;vascript").replace(/expression/gi,"expr&#101;ssion").replace(/onload/gi,"onlo&#97;d").replace(/script/gi,"&#115;cript").replace(/onerror/gi,"on&#101;rror");return b===!0?c:c.replace(/>/g,"&gt;").replace(/</g,"&lt;")},b.utils.stripTags=function(b){return a.trim(b.replace(/(<([^>]+)>)/gi,""))},b.utils.EventEmitter=function(){this._mSubscriptions={},this._mSubscriptions[b.utils.EventEmitter.ALL_EVENT]=[],this.on=function(a,c,d){if(!b.utils.isFunction(c))throw new Error("Tried to listen to event "+a+" with non-function callback "+c);this._mSubscriptions[a]||(this._mSubscriptions[a]=[]),this._mSubscriptions[a].push({fn:c,ctx:d})},this.emit=function(a){var c,d,e;if(e=Array.prototype.slice.call(arguments,1),this._mSubscriptions[a])for(c=0;c<this._mSubscriptions[a].length;c++)d=this._mSubscriptions[a][c].ctx||{},this._mSubscriptions[a][c].fn.apply(d,e);for(e.unshift(a),c=0;c<this._mSubscriptions[b.utils.EventEmitter.ALL_EVENT].length;c++)d=this._mSubscriptions[b.utils.EventEmitter.ALL_EVENT][c].ctx||{},this._mSubscriptions[b.utils.EventEmitter.ALL_EVENT][c].fn.apply(d,e)},this.unbind=function(a,b,c){if(!this._mSubscriptions[a])throw new Error("No subscribtions to unsubscribe for event "+a);var d,e=!1;for(d=0;d<this._mSubscriptions[a].length;d++)b&&this._mSubscriptions[a][d].fn!==b||c&&c!==this._mSubscriptions[a][d].ctx||(this._mSubscriptions[a].splice(d,1),e=!0);if(e===!1)throw new Error("Nothing to unbind for "+a)},this.off=this.unbind,this.trigger=this.emit},b.utils.EventEmitter.ALL_EVENT="__all",b.utils.DragListener=function(c,d){b.utils.EventEmitter.call(this),this._eElement=a(c),this._oDocument=a(document),this._eBody=a(document.body),this._nButtonCode=d||0,this._nDelay=200,this._nDistance=10,this._nX=0,this._nY=0,this._nOriginalX=0,this._nOriginalY=0,this._bDragging=!1,this._fMove=b.utils.fnBind(this.onMouseMove,this),this._fUp=b.utils.fnBind(this.onMouseUp,this),this._fDown=b.utils.fnBind(this.onMouseDown,this),this._eElement.on("mousedown touchstart",this._fDown)},b.utils.DragListener.timeout=null,b.utils.copy(b.utils.DragListener.prototype,{destroy:function(){this._eElement.unbind("mousedown touchstart",this._fDown)},onMouseDown:function(a){if(a.preventDefault(),0==a.button){var c=this._getCoordinates(a);this._nOriginalX=c.x,this._nOriginalY=c.y,this._oDocument.on("mousemove touchmove",this._fMove),this._oDocument.one("mouseup touchend",this._fUp),this._timeout=setTimeout(b.utils.fnBind(this._startDrag,this),this._nDelay)}},onMouseMove:function(a){if(null!=this._timeout){a.preventDefault();var b=this._getCoordinates(a);this._nX=b.x-this._nOriginalX,this._nY=b.y-this._nOriginalY,this._bDragging===!1&&(Math.abs(this._nX)>this._nDistance||Math.abs(this._nY)>this._nDistance)&&(clearTimeout(this._timeout),this._startDrag()),this._bDragging&&this.emit("drag",this._nX,this._nY,a)}},onMouseUp:function(a){null!=this._timeout&&(clearTimeout(this._timeout),this._eBody.removeClass("lm_dragging"),this._eElement.removeClass("lm_dragging"),this._oDocument.find("iframe").css("pointer-events",""),this._oDocument.unbind("mousemove touchmove",this._fMove),this._bDragging===!0&&(this._bDragging=!1,this.emit("dragStop",a,this._nOriginalX+this._nX)))},_startDrag:function(){this._bDragging=!0,this._eBody.addClass("lm_dragging"),this._eElement.addClass("lm_dragging"),this._oDocument.find("iframe").css("pointer-events","none"),this.emit("dragStart",this._nOriginalX,this._nOriginalY)},_getCoordinates:function(a){var b={};return"touch"===a.type.substr(0,5)?(b.x=a.originalEvent.targetTouches[0].pageX,b.y=a.originalEvent.targetTouches[0].pageY):(b.x=a.pageX,b.y=a.pageY),b}}),b.LayoutManager=function(c,d){if(!a||"function"!=typeof a.noConflict){var e="jQuery is missing as dependency for GoldenLayout. ";throw e+='Please either expose $ on GoldenLayout\'s scope (e.g. window) or add "jquery" to ',e+="your paths when using RequireJS/AMD",new Error(e)}b.utils.EventEmitter.call(this),this.isInitialised=!1,this._isFullPage=!1,this._resizeTimeoutId=null,this._components={"lm-react-component":b.utils.ReactComponentHandler},this._itemAreas=[],this._resizeFunction=b.utils.fnBind(this._onResize,this),this._unloadFunction=b.utils.fnBind(this._onUnload,this),this._maximisedItem=null,this._maximisePlaceholder=a('<div class="lm_maximise_place"></div>'),this._creationTimeoutPassed=!1,this._subWindowsCreated=!1,this._dragSources=[],this.width=null,this.height=null,this.root=null,this.openPopouts=[],this.selectedItem=null,this.isSubWindow=!1,this.eventHub=new b.utils.EventHub(this),this.config=this._createConfig(c),this.container=d,this.dropTargetIndicator=null,this.transitionIndicator=null,this.tabDropPlaceholder=a('<div class="lm_drop_tab_placeholder"></div>'),this.isSubWindow===!0&&a("body").css("visibility","hidden"),this._typeToItem={column:b.utils.fnBind(b.items.RowOrColumn,this,[!0]),row:b.utils.fnBind(b.items.RowOrColumn,this,[!1]),stack:b.items.Stack,component:b.items.Component}},b.LayoutManager.__lm=b,b.LayoutManager.minifyConfig=function(a){return(new b.utils.ConfigMinifier).minifyConfig(a)},b.LayoutManager.unminifyConfig=function(a){return(new b.utils.ConfigMinifier).unminifyConfig(a)},b.utils.copy(b.LayoutManager.prototype,{registerComponent:function(a,b){if("function"!=typeof b)throw new Error("Please register a constructor function");if(void 0!==this._components[a])throw new Error("Component "+a+" is already registered");this._components[a]=b},toConfig:function(a){var c,d,e;if(this.isInitialised===!1)throw new Error("Can't create config, layout not yet initialised");if(a&&!(a instanceof b.items.AbstractContentItem))throw new Error("Root must be a ContentItem");for(c={settings:b.utils.copy({},this.config.settings),dimensions:b.utils.copy({},this.config.dimensions),labels:b.utils.copy({},this.config.labels)},c.content=[],d=function(a,b){var c,e;for(c in b.config)"content"!==c&&(a[c]=b.config[c]);if(b.contentItems.length)for(a.content=[],e=0;e<b.contentItems.length;e++)a.content[e]={},d(a.content[e],b.contentItems[e])},a?d(c,{contentItems:[a]}):d(c,this.root),this._$reconcilePopoutWindows(),c.openPopouts=[],e=0;e<this.openPopouts.length;e++)c.openPopouts.push(this.openPopouts[e].toConfig());return c.maximisedItemId=this._maximisedItem?"__glMaximised":null,c},getComponent:function(a){if(void 0===this._components[a])throw new b.errors.ConfigurationError('Unknown component "'+a+'"');return this._components[a]},init:function(){return this._subWindowsCreated===!1&&(this._createSubWindows(),this._subWindowsCreated=!0),"loading"===document.readyState||null===document.body?void a(document).ready(b.utils.fnBind(this.init,this)):this.isSubWindow===!0&&this._creationTimeoutPassed===!1?(setTimeout(b.utils.fnBind(this.init,this),7),void(this._creationTimeoutPassed=!0)):(this.isSubWindow===!0&&this._adjustToWindowMode(),this._setContainer(),this.dropTargetIndicator=new b.controls.DropTargetIndicator(this.container),this.transitionIndicator=new b.controls.TransitionIndicator,this.updateSize(),this._create(this.config),this._bindEvents(),this.isInitialised=!0,void this.emit("initialised"))},updateSize:function(a,b){2===arguments.length?(this.width=a,this.height=b):(this.width=this.container.width(),this.height=this.container.height()),this.isInitialised===!0&&(this.root.callDownwards("setSize"),this._maximisedItem&&(this._maximisedItem.element.width(this.container.width()),this._maximisedItem.element.height(this.container.height()),this._maximisedItem.callDownwards("setSize")))},destroy:function(){this.isInitialised!==!1&&(this._onUnload(),a(window).off("resize",this._resizeFunction),a(window).off("unload beforeunload",this._unloadFunction),this.root.callDownwards("_$destroy",[],!0),this.root.contentItems=[],this.tabDropPlaceholder.remove(),this.dropTargetIndicator.destroy(),this.transitionIndicator.destroy(),this.eventHub.destroy(),this._dragSources.forEach(function(a){a._dragListener.destroy(),a._element=null,a._itemConfig=null,a._dragListener=null}),this._dragSources=[])},createContentItem:function(a,c){var d,e;if("string"!=typeof a.type)throw new b.errors.ConfigurationError("Missing parameter 'type'",a);if("react-component"===a.type&&(a.type="component",a.componentName="lm-react-component"),!this._typeToItem[a.type])throw d="Unknown type '"+a.type+"'. Valid types are "+b.utils.objectKeys(this._typeToItem).join(","),new b.errors.ConfigurationError(d);return"component"!==a.type||c instanceof b.items.Stack||!c||this.isSubWindow===!0&&c instanceof b.items.Root||(a={type:"stack",width:a.width,height:a.height,content:[a]}),e=new this._typeToItem[a.type](this,a,c)},createPopout:function(a,c,d,e){var i,j,k,l,m,n,f=a,g=a instanceof b.items.AbstractContentItem,h=this;if(d=d||null,g){for(f=this.toConfig(a).content,d=b.utils.getUniqueId(),l=a.parent,m=a;1===l.contentItems.length&&!l.isRoot;)l=l.parent,m=m.parent;l.addId(d),isNaN(e)&&(e=b.utils.indexOf(m,l.contentItems))}else f instanceof Array||(f=[f]);return!c&&g&&(i=window.screenX||window.screenLeft,j=window.screenY||window.screenTop,k=a.element.offset(),c={left:i+k.left,top:j+k.top,width:a.element.width(),height:a.element.height()}),c||g||(c={left:window.screenX||window.screenLeft+20,top:window.screenY||window.screenTop+20,width:500,height:309}),g&&a.remove(),n=new b.controls.BrowserPopout(f,c,d,e,this),n.on("initialised",function(){h.emit("windowOpened",n)}),n.on("closed",function(){h._$reconcilePopoutWindows()}),this.openPopouts.push(n),n},createDragSource:function(c,d){this.config.settings.constrainDragToContainer=!1;var e=new b.controls.DragSource(a(c),d,this);return this._dragSources.push(e),e},selectItem:function(a,b){if(this.config.settings.selectionEnabled!==!0)throw new Error("Please set selectionEnabled to true to use this feature");a!==this.selectedItem&&(null!==this.selectedItem&&this.selectedItem.deselect(),a&&b!==!0&&a.select(),this.selectedItem=a,this.emit("selectionChanged",a))},_$maximiseItem:function(a){null!==this._maximisedItem&&this._$minimiseItem(this._maximisedItem),this._maximisedItem=a,this._maximisedItem.addId("__glMaximised"),a.element.addClass("lm_maximised"),a.element.after(this._maximisePlaceholder),this.root.element.prepend(a.element),a.element.width(this.container.width()),a.element.height(this.container.height()),a.callDownwards("setSize"),this._maximisedItem.emit("maximised"),this.emit("stateChanged")},_$minimiseItem:function(a){a.element.removeClass("lm_maximised"),a.removeId("__glMaximised"),this._maximisePlaceholder.after(a.element),this._maximisePlaceholder.remove(),a.parent.callDownwards("setSize"),this._maximisedItem=null,a.emit("minimised"),this.emit("stateChanged")},_$closeWindow:function(){window.setTimeout(function(){window.close()},1)},_$getArea:function(a,b){var c,d,e=1/0,f=null;for(c=0;c<this._itemAreas.length;c++)d=this._itemAreas[c],a>d.x1&&a<d.x2&&b>d.y1&&b<d.y2&&e>d.surface&&(e=d.surface,f=d);return f},_$calculateItemAreas:function(){var a,b,c=this._getAllContentItems();if(this._itemAreas=[],1===c.length)return void this._itemAreas.push(this.root._$getArea());for(a=0;a<c.length;a++)c[a].isStack&&(b=c[a]._$getArea(),null!==b&&(b instanceof Array?this._itemAreas=this._itemAreas.concat(b):this._itemAreas.push(b)))},_$normalizeContentItem:function(c,d){if(!c)throw new Error("No content item defined");if(b.utils.isFunction(c)&&(c=c()),c instanceof b.items.AbstractContentItem)return c;if(a.isPlainObject(c)&&c.type){var e=this.createContentItem(c,d);return e.callDownwards("_$init"),e}throw new Error("Invalid contentItem")},_$reconcilePopoutWindows:function(){var b,a=[];for(b=0;b<this.openPopouts.length;b++)this.openPopouts[b].getWindow().closed===!1?a.push(this.openPopouts[b]):this.emit("windowClosed",this.openPopouts[b]);this.openPopouts.length!==a.length&&(this.emit("stateChanged"),this.openPopouts=a)},_getAllContentItems:function(){var a=[],b=function(c){if(a.push(c),c.contentItems instanceof Array)for(var d=0;d<c.contentItems.length;d++)b(c.contentItems[d])};return b(this.root),a},_bindEvents:function(){this._isFullPage&&a(window).resize(this._resizeFunction),a(window).on("unload beforeunload",this._unloadFunction)},_onResize:function(){clearTimeout(this._resizeTimeoutId),this._resizeTimeoutId=setTimeout(b.utils.fnBind(this.updateSize,this),100)},_createConfig:function(c){var d=b.utils.getQueryStringParam("gl-window");d&&(this.isSubWindow=!0,c=localStorage.getItem(d),c=JSON.parse(c),c=(new b.utils.ConfigMinifier).unminifyConfig(c),localStorage.removeItem(d)),c=a.extend(!0,{},b.config.defaultConfig,c);var e=function(a){for(var b in a)"props"!==b&&"object"==typeof a[b]?e(a[b]):"type"===b&&"react-component"===a[b]&&(a.type="component",a.componentName="lm-react-component")};return e(c),c.settings.hasHeaders===!1&&(c.dimensions.headerHeight=0),c},_adjustToWindowMode:function(){var c=a('<div class="lm_popin" title="'+this.config.labels.popin+'"><div class="lm_icon"></div><div class="lm_bg"></div></div>');c.click(b.utils.fnBind(function(){this.emit("popIn")},this)),document.title=b.utils.stripTags(this.config.content[0].title),a("head").append(a("body link, body style, template, .gl_keep")),this.container=a("body").html("").css("visibility","visible").append(c);document.body.offsetHeight;window.__glInstance=this},_createSubWindows:function(){var a,b;for(a=0;a<this.config.openPopouts.length;a++)b=this.config.openPopouts[a],this.createPopout(b.content,b.dimensions,b.parentId,b.indexInParent)},_setContainer:function(){var b=a(this.container||"body");if(0===b.length)throw new Error("GoldenLayout container not found");if(b.length>1)throw new Error("GoldenLayout more than one container element specified");b[0]===document.body&&(this._isFullPage=!0,a("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"})),this.container=b},_create:function(a){var c;if(!(a.content instanceof Array))throw c=void 0===a.content?"Missing setting 'content' on top level of configuration":"Configuration parameter 'content' must be an array",new b.errors.ConfigurationError(c,a);if(a.content.length>1)throw c="Top level content can't contain more then one element.",new b.errors.ConfigurationError(c,a);this.root=new b.items.Root(this,{content:a.content},this.container),this.root.callDownwards("_$init"),"__glMaximised"===a.maximisedItemId&&this.root.getItemsById(a.maximisedItemId)[0].toggleMaximise()},_onUnload:function(){if(this.config.settings.closePopoutsOnUnload===!0)for(var a=0;a<this.openPopouts.length;a++)this.openPopouts[a].close()}}),function(){"function"==typeof define&&define.amd?define(["jquery"],function(c){return a=c,b.LayoutManager}):"object"==typeof exports?module.exports=b.LayoutManager:window.GoldenLayout=b.LayoutManager}(),b.config.itemDefaultConfig={isClosable:!0,reorderEnabled:!0,title:""},b.config.defaultConfig={openPopouts:[],settings:{hasHeaders:!0,constrainDragToContainer:!0,reorderEnabled:!0,selectionEnabled:!1,popoutWholeStack:!1,blockedPopoutsThrowError:!0,closePopoutsOnUnload:!0,showPopoutIcon:!0,showMaximiseIcon:!0,showCloseIcon:!0},dimensions:{borderWidth:5,minItemHeight:10,minItemWidth:10,headerHeight:20,dragProxyWidth:300,dragProxyHeight:200},labels:{close:"close",maximise:"maximise",minimise:"minimise",popout:"open in new window",popin:"pop in"}},b.container.ItemContainer=function(c,d,e){b.utils.EventEmitter.call(this),this.width=null,this.height=null,this.title=c.componentName,this.parent=d,this.layoutManager=e,this.isHidden=!1,this._config=c,this._element=a(['<div class="lm_item_container">','<div class="lm_content"></div>',"</div>"].join("")),this._contentElement=this._element.find(".lm_content")},b.utils.copy(b.container.ItemContainer.prototype,{getElement:function(){return this._contentElement},hide:function(){this.emit("hide"),this.isHidden=!0,this._element.hide()},show:function(){this.emit("show"),this.isHidden=!1,this._element.show(),0==this.height&&0==this.width||this.emit("shown")},setSize:function(a,b){for(var e,f,g,h,i,j,c=this.parent,d=this;!c.isColumn&&!c.isRow;)if(d=c,c=c.parent,c.isRoot)return!1;for(g=c.isColumn?"height":"width",h="height"===g?b:a,e=this[g]*(1/(d.config[g]/100)),f=h/e*100,i=(d.config[g]-f)/c.contentItems.length,j=0;j<c.contentItems.length;j++)c.contentItems[j]===d?c.contentItems[j].config[g]=f:c.contentItems[j].config[g]+=i;return c.callDownwards("setSize"),!0},close:function(){this._config.isClosable&&(this.emit("close"),this.parent.close())},getState:function(){return this._config.componentState},extendState:function(b){this.setState(a.extend(!0,this.getState(),b))},setState:function(a){this._config.componentState=a,this.parent.emitBubblingEvent("stateChanged")},setTitle:function(a){this.parent.setTitle(a)},_$setSize:function(a,b){a===this.width&&b===this.height||(this.width=a,this.height=b,this._contentElement.width(this.width).height(this.height),this.emit("resize"))}}),b.controls.BrowserPopout=function(a,c,d,e,f){b.utils.EventEmitter.call(this),this.isInitialised=!1,this._config=a,this._dimensions=c,this._parentId=d,this._indexInParent=e,this._layoutManager=f,this._popoutWindow=null,this._id=null,this._createWindow()},b.utils.copy(b.controls.BrowserPopout.prototype,{toConfig:function(){if(this.isInitialised===!1)throw new Error("Can't create config, layout not yet initialised");return{dimensions:{width:this.getGlInstance().width,height:this.getGlInstance().height,left:this._popoutWindow.screenX||this._popoutWindow.screenLeft,top:this._popoutWindow.screenY||this._popoutWindow.screenTop},content:this.getGlInstance().toConfig().content,parentId:this._parentId,indexInParent:this._indexInParent}},getGlInstance:function(){return this._popoutWindow.__glInstance},getWindow:function(){return this._popoutWindow},close:function(){if(this.getGlInstance())this.getGlInstance()._$closeWindow();else try{this.getWindow().close()}catch(a){}},popIn:function(){var b,c,d=this._indexInParent;this._parentId&&(b=a.extend(!0,{},this.getGlInstance().toConfig()).content[0],c=this._layoutManager.root.getItemsById(this._parentId)[0],c||(c=this._layoutManager.root.contentItems.length>0?this._layoutManager.root.contentItems[0]:this._layoutManager.root,d=0)),c.addChild(b,this._indexInParent),this.close()},_createWindow:function(){var c,d=this._createUrl(),e=Math.floor(1e6*Math.random()).toString(36),f=this._serializeWindowOptions({width:this._dimensions.width,height:this._dimensions.height,innerWidth:this._dimensions.width,innerHeight:this._dimensions.height,menubar:"no",toolbar:"no",location:"no",personalbar:"no",resizable:"yes",scrollbars:"no",status:"no"});if(this._popoutWindow=window.open(d,e,f),this._popoutWindow)a(this._popoutWindow).on("load",b.utils.fnBind(this._positionWindow,this)).on("unload beforeunload",b.utils.fnBind(this._onClose,this)),c=setInterval(b.utils.fnBind(function(){this._popoutWindow.__glInstance&&this._popoutWindow.__glInstance.isInitialised&&(this._onInitialised(),clearInterval(c))},this),10);else if(this._layoutManager.config.settings.blockedPopoutsThrowError===!0){var g=new Error("Popout blocked");throw g.type="popoutBlocked",g}},_serializeWindowOptions:function(a){var c,b=[];for(c in a)b.push(c+"="+a[c]);return b.join(",")},_createUrl:function(){var d,a={content:this._config},c="gl-window-config-"+b.utils.getUniqueId();a=(new b.utils.ConfigMinifier).minifyConfig(a);try{localStorage.setItem(c,JSON.stringify(a))}catch(a){throw new Error("Error while writing to localStorage "+a.toString())}return d=document.location.href.split("?"),1===d.length?d[0]+"?gl-window="+c:document.location.href+"&gl-window="+c},_positionWindow:function(){this._popoutWindow.moveTo(this._dimensions.left,this._dimensions.top),this._popoutWindow.focus()},_onInitialised:function(){this.isInitialised=!0,this.getGlInstance().on("popIn",this.popIn,this),this.emit("initialised")},_onClose:function(){setTimeout(b.utils.fnBind(this.emit,this,["closed"]),50)}}),b.controls.DragProxy=function(c,d,e,f,g,h){b.utils.EventEmitter.call(this),this._dragListener=e,this._layoutManager=f,this._contentItem=g,this._originalParent=h,this._area=null,this._lastValidArea=null,this._dragListener.on("drag",this._onDrag,this),this._dragListener.on("dragStop",this._onDrop,this),this.element=a(b.controls.DragProxy._template),this.element.css({left:c,top:d}),this.element.find(".lm_tab").attr("title",b.utils.stripTags(this._contentItem.config.title)),this.element.find(".lm_title").html(this._contentItem.config.title),this.childElementContainer=this.element.find(".lm_content"),this.childElementContainer.append(g.element),this._updateTree(),this._layoutManager._$calculateItemAreas(),this._setDimensions(),a(document.body).append(this.element);var i=this._layoutManager.container.offset();this._minX=i.left,this._minY=i.top,this._maxX=this._layoutManager.container.width()+this._minX,this._maxY=this._layoutManager.container.height()+this._minY,this._width=this.element.width(),this._height=this.element.height(),this._setDropPosition(c,d)},b.controls.DragProxy._template='<div class="lm_dragProxy"><div class="lm_header"><ul class="lm_tabs"><li class="lm_tab lm_active"><i class="lm_left"></i><span class="lm_title"></span><i class="lm_right"></i></li></ul></div><div class="lm_content"></div></div>',b.utils.copy(b.controls.DragProxy.prototype,{_onDrag:function(a,b,c){var d=c.pageX,e=c.pageY,f=d>this._minX&&d<this._maxX&&e>this._minY&&e<this._maxY;(f||this._layoutManager.config.settings.constrainDragToContainer!==!0)&&this._setDropPosition(d,e)},_setDropPosition:function(a,b){this.element.css({left:a,top:b}),this._area=this._layoutManager._$getArea(a,b),null!==this._area&&(this._lastValidArea=this._area,this._area.contentItem._$highlightDropZone(a,b,this._area))},_onDrop:function(){this._layoutManager.dropTargetIndicator.hide(),null!==this._area?this._area.contentItem._$onDrop(this._contentItem):null!==this._lastValidArea?this._lastValidArea.contentItem._$onDrop(this._contentItem):this._originalParent?this._originalParent.addChild(this._contentItem):this._contentItem._$destroy(),this.element.remove(),this._layoutManager.emit("itemDropped",this._contentItem)},_updateTree:function(){this._contentItem.parent&&this._contentItem.parent.removeChild(this._contentItem,!0),this._contentItem._$setParent(this)},_setDimensions:function(){var a=this._layoutManager.config.dimensions,b=a.dragProxyWidth,c=a.dragProxyHeight-a.headerHeight;this.childElementContainer.width(b),this.childElementContainer.height(c),this._contentItem.element.width(b),this._contentItem.element.height(c),this._contentItem.callDownwards("_$show"),this._contentItem.callDownwards("setSize")}}),b.controls.DragSource=function(a,b,c){this._element=a,this._itemConfig=b,this._layoutManager=c,this._dragListener=null,this._createDragListener()},b.utils.copy(b.controls.DragSource.prototype,{_createDragListener:function(){null!==this._dragListener&&this._dragListener.destroy(),this._dragListener=new b.utils.DragListener(this._element),this._dragListener.on("dragStart",this._onDragStart,this),this._dragListener.on("dragStop",this._createDragListener,this)},_onDragStart:function(c,d){var e=this._itemConfig;b.utils.isFunction(e)&&(e=e());var f=this._layoutManager._$normalizeContentItem(a.extend(!0,{},e)),g=new b.controls.DragProxy(c,d,this._dragListener,this._layoutManager,f,null);this._layoutManager.transitionIndicator.transitionElements(this._element,g.element)}}),b.controls.DropTargetIndicator=function(){this.element=a(b.controls.DropTargetIndicator._template),a(document.body).append(this.element)},b.controls.DropTargetIndicator._template='<div class="lm_dropTargetIndicator"><div class="lm_inner"></div></div>',b.utils.copy(b.controls.DropTargetIndicator.prototype,{destroy:function(){this.element.remove()},highlight:function(a,b,c,d){this.highlightArea({x1:a,y1:b,x2:c,y2:d})},highlightArea:function(a){this.element.css({left:a.x1,top:a.y1,width:a.x2-a.x1,height:a.y2-a.y1}).show()},hide:function(){this.element.hide()}}),b.controls.Header=function(c,d){b.utils.EventEmitter.call(this),this.layoutManager=c,this.element=a(b.controls.Header._template),this.layoutManager.config.settings.selectionEnabled===!0&&(this.element.addClass("lm_selectable"),this.element.click(b.utils.fnBind(this._onHeaderClick,this))),this.element.height(c.config.dimensions.headerHeight),this.tabsContainer=this.element.find(".lm_tabs"),this.controlsContainer=this.element.find(".lm_controls"),this.parent=d,this.parent.on("resize",this._updateTabSizes,this),this.tabs=[],this.activeContentItem=null,this.closeButton=null,this._createControls()},b.controls.Header._template=['<div class="lm_header">','<ul class="lm_tabs"></ul>','<ul class="lm_controls"></ul>',"</div>"].join(""),b.utils.copy(b.controls.Header.prototype,{createTab:function(a,c){var d,e;for(e=0;e<this.tabs.length;e++)if(this.tabs[e].contentItem===a)return;return d=new b.controls.Tab(this,a),0===this.tabs.length?(this.tabs.push(d),void this.tabsContainer.append(d.element)):(void 0===c&&(c=this.tabs.length),c>0?this.tabs[c-1].element.after(d.element):this.tabs[0].element.before(d.element),this.tabs.splice(c,0,d),void this._updateTabSizes())},removeTab:function(a){for(var b=0;b<this.tabs.length;b++)if(this.tabs[b].contentItem===a)return this.tabs[b]._$destroy(),void this.tabs.splice(b,1);throw new Error("contentItem is not controlled by this header")},setActiveContentItem:function(a){var b,c;for(b=0;b<this.tabs.length;b++)c=this.tabs[b].contentItem===a,this.tabs[b].setActive(c),c===!0&&(this.activeContentItem=a,this.parent.config.activeItemIndex=b);this._updateTabSizes(),this.parent.emitBubblingEvent("stateChanged")},_$setClosable:function(a){return!(!this.closeButton||!this._isClosable())&&(this.closeButton.element[a?"show":"hide"](),!0)},_$destroy:function(){this.emit("destroy");for(var a=0;a<this.tabs.length;a++)this.tabs[a]._$destroy();this.element.remove()},_createControls:function(){var a,c,d,e,f,g,h;this.layoutManager.config.settings.showPopoutIcon&&(c=b.utils.fnBind(this._onPopoutClick,this),d=this.layoutManager.config.labels.popout,new b.controls.HeaderButton(this,d,"lm_popout",c)),this.layoutManager.config.settings.showMaximiseIcon&&(g=b.utils.fnBind(this.parent.toggleMaximise,this.parent),e=this.layoutManager.config.labels.maximise,f=this.layoutManager.config.labels.minimise,h=new b.controls.HeaderButton(this,e,"lm_maximise",g),this.parent.on("maximised",function(){h.element.attr("title",f)}),this.parent.on("minimised",function(){h.element.attr("title",e)})),this._isClosable()&&(a=b.utils.fnBind(this.parent.remove,this.parent),d=this.layoutManager.config.labels.close,this.closeButton=new b.controls.HeaderButton(this,d,"lm_close",a))},_isClosable:function(){return this.parent.config.isClosable&&this.layoutManager.config.settings.showCloseIcon},_onPopoutClick:function(){this.layoutManager.config.settings.popoutWholeStack===!0?this.parent.popout():this.activeContentItem.popout()},_onHeaderClick:function(a){a.target===this.element[0]&&this.parent.select()},_updateTabSizes:function(){if(0!==this.tabs.length){var c,d,e,f,a=this.element.outerWidth()-this.controlsContainer.outerWidth(),b=0;for(d=0;d<this.tabs.length;d++)c=this.tabs[d].element,c.css("z-index",this.tabs.length-d),b+=c.outerWidth()+parseInt(c.css("margin-right"),10);for(f=(b-a)/(this.tabs.length-1),d=0;d<this.tabs.length;d++)e=!this.tabs[d].isActive&&f>0?"-"+Math.floor(f)+"px":"",this.tabs[d].element.css("margin-left",e);a<b?this.element.css("overflow","hidden"):this.element.css("overflow","visible")}}}),b.controls.HeaderButton=function(b,c,d,e){this._header=b,this.element=a('<li class="'+d+'" title="'+c+'"></li>'),this._header.on("destroy",this._$destroy,this),this._action=e,this.element.click(this._action),this._header.controlsContainer.append(this.element)},b.utils.copy(b.controls.HeaderButton.prototype,{_$destroy:function(){this.element.off(),this.element.remove()}}),b.controls.Splitter=function(a,c){this._isVertical=a,this._size=c,this.element=this._createElement(),this._dragListener=new b.utils.DragListener(this.element)},b.utils.copy(b.controls.Splitter.prototype,{on:function(a,b,c){this._dragListener.on(a,b,c)},_$destroy:function(){this.element.remove()},_createElement:function(){var b=a('<div class="lm_splitter"><div class="lm_drag_handle"></div></div>');return b.addClass("lm_"+(this._isVertical?"vertical":"horizontal")),b[this._isVertical?"height":"width"](this._size),b}}),b.controls.Tab=function(c,d){this.header=c,this.contentItem=d,this.element=a(b.controls.Tab._template),this.titleElement=this.element.find(".lm_title"),this.closeElement=this.element.find(".lm_close_tab"),this.closeElement[d.config.isClosable?"show":"hide"](),this.isActive=!1,this.setTitle(d.config.title),this.contentItem.on("titleChanged",this.setTitle,this),this._layoutManager=this.contentItem.layoutManager,this._layoutManager.config.settings.reorderEnabled===!0&&d.config.reorderEnabled===!0&&(this._dragListener=new b.utils.DragListener(this.element),this._dragListener.on("dragStart",this._onDragStart,this)),this._onTabClickFn=b.utils.fnBind(this._onTabClick,this),this._onCloseClickFn=b.utils.fnBind(this._onCloseClick,this),this.element.mousedown(this._onTabClickFn),this.contentItem.config.isClosable?this.closeElement.click(this._onCloseClickFn):this.closeElement.remove(),this.contentItem.tab=this,this.contentItem.emit("tab",this),this.contentItem.layoutManager.emit("tabCreated",this),this.contentItem.isComponent&&(this.contentItem.container.tab=this,this.contentItem.container.emit("tab",this))},b.controls.Tab._template='<li class="lm_tab"><i class="lm_left"></i><span class="lm_title"></span><div class="lm_close_tab"></div><i class="lm_right"></i></li>',b.utils.copy(b.controls.Tab.prototype,{setTitle:function(a){this.element.attr("title",b.utils.stripTags(a)),this.titleElement.html(a)},setActive:function(a){a!==this.isActive&&(this.isActive=a,a?this.element.addClass("lm_active"):this.element.removeClass("lm_active"));
},_$destroy:function(){this.element.off("click",this._onTabClickFn),this.closeElement.off("click",this._onCloseClickFn),this._dragListener&&(this._dragListener.off("dragStart",this._onDragStart),this._dragListener=null),this.element.remove()},_onDragStart:function(a,c){this.contentItem.parent.isMaximised===!0&&this.contentItem.parent.toggleMaximise(),new b.controls.DragProxy(a,c,this._dragListener,this._layoutManager,this.contentItem,this.header.parent)},_onTabClick:function(a){if(0===a.button){var b=this.header.parent.getActiveContentItem();this.contentItem!==b&&this.header.parent.setActiveContentItem(this.contentItem)}else 1===a.button&&this.contentItem.config.isClosable&&this._onCloseClick(a)},_onCloseClick:function(a){a.stopPropagation(),this.header.parent.removeChild(this.contentItem)}}),b.controls.TransitionIndicator=function(){this._element=a('<div class="lm_transition_indicator"></div>'),a(document.body).append(this._element),this._toElement=null,this._fromDimensions=null,this._totalAnimationDuration=200,this._animationStartTime=null},b.utils.copy(b.controls.TransitionIndicator.prototype,{destroy:function(){this._element.remove()},transitionElements:function(a,c){},_nextAnimationFrame:function(){var e,a=this._measure(this._toElement),c=(b.utils.now()-this._animationStartTime)/this._totalAnimationDuration,d={};if(c>=1)return void this._element.hide();a.opacity=0;for(e in this._fromDimensions)d[e]=this._fromDimensions[e]+(a[e]-this._fromDimensions[e])*c;this._element.css(d),b.utils.animFrame(b.utils.fnBind(this._nextAnimationFrame,this))},_measure:function(a){var b=a.offset();return{left:b.left,top:b.top,width:a.outerWidth(),height:a.outerHeight()}}}),b.errors.ConfigurationError=function(a,b){Error.call(this),this.name="Configuration Error",this.message=a,this.node=b},b.errors.ConfigurationError.prototype=new Error,b.items.AbstractContentItem=function(a,c,d){b.utils.EventEmitter.call(this),this.config=this._extendItemNode(c),this.type=c.type,this.contentItems=[],this.parent=d,this.isInitialised=!1,this.isMaximised=!1,this.isRoot=!1,this.isRow=!1,this.isColumn=!1,this.isStack=!1,this.isComponent=!1,this.layoutManager=a,this._pendingEventPropagations={},this._throttledEvents=["stateChanged"],this.on(b.utils.EventEmitter.ALL_EVENT,this._propagateEvent,this),c.content&&this._createContentItems(c)},b.utils.copy(b.items.AbstractContentItem.prototype,{setSize:function(){throw new Error("Abstract Method")},callDownwards:function(a,b,c,d){var e;for(c!==!0&&d!==!0&&this[a].apply(this,b||[]),e=0;e<this.contentItems.length;e++)this.contentItems[e].callDownwards(a,b,c);c===!0&&d!==!0&&this[a].apply(this,b||[])},removeChild:function(a,c){var d=b.utils.indexOf(a,this.contentItems);if(d===-1)throw new Error("Can't remove child item. Unknown content item");c!==!0&&this.contentItems[d]._$destroy(),this.contentItems.splice(d,1),this.config.content.splice(d,1),this.contentItems.length>0?this.callDownwards("setSize"):this instanceof b.items.Root||this.config.isClosable!==!0||this.parent.removeChild(this)},addChild:function(a,b){void 0===b&&(b=this.contentItems.length),this.contentItems.splice(b,0,a),void 0===this.config.content&&(this.config.content=[]),this.config.content.splice(b,0,a.config),a.parent=this,a.parent.isInitialised===!0&&a.isInitialised===!1&&a._$init()},replaceChild:function(a,c,d){c=this.layoutManager._$normalizeContentItem(c);var e=b.utils.indexOf(a,this.contentItems),f=a.element[0].parentNode;if(e===-1)throw new Error("Can't replace child. oldChild is not child of this");f.replaceChild(c.element[0],a.element[0]),d===!0&&(a.parent=null,a._$destroy()),this.contentItems[e]=c,c.parent=this,this.isStack&&(this.header.tabs[e].contentItem=c),c.parent.isInitialised===!0&&c.isInitialised===!1&&c._$init(),this.callDownwards("setSize")},remove:function(){this.parent.removeChild(this)},popout:function(){var a=this.layoutManager.createPopout(this);return this.emitBubblingEvent("stateChanged"),a},toggleMaximise:function(){this.isMaximised===!0?this.layoutManager._$minimiseItem(this):this.layoutManager._$maximiseItem(this),this.isMaximised=!this.isMaximised,this.emitBubblingEvent("stateChanged")},select:function(){this.layoutManager.selectedItem!==this&&(this.layoutManager.selectItem(this,!0),this.element.addClass("lm_selected"))},deselect:function(){this.layoutManager.selectedItem===this&&(this.layoutManager.selectedItem=null,this.element.removeClass("lm_selected"))},setTitle:function(a){this.config.title=a,this.emit("titleChanged",a),this.emit("stateChanged")},hasId:function(a){return!!this.config.id&&("string"==typeof this.config.id?this.config.id===a:this.config.id instanceof Array?b.utils.indexOf(a,this.config.id)!==-1:void 0)},addId:function(a){this.hasId(a)||(this.config.id?"string"==typeof this.config.id?this.config.id=[this.config.id,a]:this.config.id instanceof Array&&this.config.id.push(a):this.config.id=a)},removeId:function(a){if(!this.hasId(a))throw new Error("Id not found");if("string"==typeof this.config.id)delete this.config.id;else if(this.config.id instanceof Array){var c=b.utils.indexOf(a,this.config.id);this.config.id.splice(c,1)}},getItemsByFilter:function(a){var b=[],c=function(d){for(var e=0;e<d.contentItems.length;e++)a(d.contentItems[e])===!0&&b.push(d.contentItems[e]),c(d.contentItems[e])};return c(this),b},getItemsById:function(a){return this.getItemsByFilter(function(c){return c.config.id instanceof Array?b.utils.indexOf(a,c.config.id)!==-1:c.config.id===a})},getItemsByType:function(a){return this._$getItemsByProperty("type",a)},getComponentsByName:function(a){var d,b=this._$getItemsByProperty("componentName",a),c=[];for(d=0;d<b.length;d++)c.push(b[d].instance);return c},_$getItemsByProperty:function(a,b){return this.getItemsByFilter(function(c){return c[a]===b})},_$setParent:function(a){this.parent=a},_$highlightDropZone:function(a,b,c){this.layoutManager.dropTargetIndicator.highlightArea(c)},_$onDrop:function(a){this.addChild(a)},_$hide:function(){this._callOnActiveComponents("hide"),this.element.hide(),this.layoutManager.updateSize()},_$show:function(){this._callOnActiveComponents("show"),this.element.show(),this.layoutManager.updateSize(),this._callOnActiveComponents("shown")},_callOnActiveComponents:function(a){var c,d,b=this.getItemsByType("stack");for(d=0;d<b.length;d++)c=b[d].getActiveContentItem(),c&&c.isComponent&&c.container[a]()},_$destroy:function(){this.emitBubblingEvent("beforeItemDestroyed"),this.callDownwards("_$destroy",[],!0,!0),this.element.remove(),this.emitBubblingEvent("itemDestroyed")},_$getArea:function(a){a=a||this.element;var b=a.offset(),c=a.width(),d=a.height();return{x1:b.left,y1:b.top,x2:b.left+c,y2:b.top+d,surface:c*d,contentItem:this}},_$init:function(){var a;for(this.setSize(),a=0;a<this.contentItems.length;a++)this.childElementContainer.append(this.contentItems[a].element);this.isInitialised=!0,this.emitBubblingEvent("itemCreated"),this.emitBubblingEvent(this.type+"Created")},emitBubblingEvent:function(a){var c=new b.utils.BubblingEvent(a,this);this.emit(a,c)},_createContentItems:function(a){var c,d;if(!(a.content instanceof Array))throw new b.errors.ConfigurationError("content must be an Array",a);for(d=0;d<a.content.length;d++)c=this.layoutManager.createContentItem(a.content[d],this),this.contentItems.push(c)},_extendItemNode:function(a){for(var c in b.config.itemDefaultConfig)void 0===a[c]&&(a[c]=b.config.itemDefaultConfig[c]);return a},_propagateEvent:function(a,c){c instanceof b.utils.BubblingEvent&&c.isPropagationStopped===!1&&this.isInitialised===!0&&(this.isRoot===!1&&this.parent?this.parent.emit.apply(this.parent,Array.prototype.slice.call(arguments,0)):this._scheduleEventPropagationToLayoutManager(a,c))},_scheduleEventPropagationToLayoutManager:function(a,c){b.utils.indexOf(a,this._throttledEvents)===-1?this.layoutManager.emit(a,c.origin):this._pendingEventPropagations[a]!==!0&&(this._pendingEventPropagations[a]=!0,b.utils.animFrame(b.utils.fnBind(this._propagateEventToLayoutManager,this,[a,c])))},_propagateEventToLayoutManager:function(a,b){this._pendingEventPropagations[a]=!1,this.layoutManager.emit(a,b)}}),b.items.Component=function(c,d,e){b.items.AbstractContentItem.call(this,c,d,e);var f=c.getComponent(this.config.componentName),g=a.extend(!0,{},this.config.componentState||{});g.componentName=this.config.componentName,this.componentName=this.config.componentName,""===this.config.title&&(this.config.title=this.config.componentName),this.isComponent=!0,this.container=new b.container.ItemContainer(this.config,this,c),this.instance=new f(this.container,g),this.element=this.container._element},b.utils.extend(b.items.Component,b.items.AbstractContentItem),b.utils.copy(b.items.Component.prototype,{close:function(){this.parent.removeChild(this)},setSize:function(){this.container._$setSize(this.element.width(),this.element.height())},_$init:function(){b.items.AbstractContentItem.prototype._$init.call(this),this.container.emit("open")},_$hide:function(){this.container.hide(),b.items.AbstractContentItem.prototype._$hide.call(this)},_$show:function(){this.container.show(),b.items.AbstractContentItem.prototype._$show.call(this)},_$shown:function(){this.container.shown(),b.items.AbstractContentItem.prototype._$shown.call(this)},_$destroy:function(){this.container.emit("destroy"),b.items.AbstractContentItem.prototype._$destroy.call(this)},_$getArea:function(){return null}}),b.items.Root=function(c,d,e){b.items.AbstractContentItem.call(this,c,d,null),this.isRoot=!0,this.type="root",this.element=a('<div class="lm_goldenlayout lm_item lm_root"></div>'),this.childElementContainer=this.element,this._containerElement=e,this._containerElement.append(this.element)},b.utils.extend(b.items.Root,b.items.AbstractContentItem),b.utils.copy(b.items.Root.prototype,{addChild:function(a){if(this.contentItems.length>0)throw new Error("Root node can only have a single child");a=this.layoutManager._$normalizeContentItem(a,this),this.childElementContainer.append(a.element),b.items.AbstractContentItem.prototype.addChild.call(this,a),this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged")},setSize:function(){var a=this._containerElement.width(),b=this._containerElement.height();this.element.width(a),this.element.height(b),this.contentItems[0]&&(this.contentItems[0].element.width(a),this.contentItems[0].element.height(b))},_$onDrop:function(a){var b;a.isComponent===!0?(b=this.layoutManager.createContentItem({type:"stack"},this),b.addChild(a),this.addChild(b)):this.addChild(a)}}),b.items.RowOrColumn=function(c,d,e,f){b.items.AbstractContentItem.call(this,d,e,f),this.isRow=!c,this.isColumn=c,this.element=a('<div class="lm_item lm_'+(c?"column":"row")+'"></div>'),this.childElementContainer=this.element,this._splitterSize=d.config.dimensions.borderWidth,this._isColumn=c,this._dimension=c?"height":"width",this._splitter=[],this._splitterPosition=null,this._splitterMinPosition=null,this._splitterMaxPosition=null},b.utils.extend(b.items.RowOrColumn,b.items.AbstractContentItem),b.utils.copy(b.items.RowOrColumn.prototype,{addChild:function(a,c,d){var e,f,g,h;if(a=this.layoutManager._$normalizeContentItem(a,this),void 0===c&&(c=this.contentItems.length),this.contentItems.length>0?(h=this._createSplitter(Math.max(0,c-1)).element,c>0?(this.contentItems[c-1].element.after(h),h.after(a.element)):(this.contentItems[0].element.before(h),h.before(a.element))):this.childElementContainer.append(a.element),b.items.AbstractContentItem.prototype.addChild.call(this,a,c),e=1/this.contentItems.length*100,d===!0)return void this.emitBubblingEvent("stateChanged");for(g=0;g<this.contentItems.length;g++)this.contentItems[g]===a?a.config[this._dimension]=e:(f=this.contentItems[g].config[this._dimension]*=(100-e)/100,this.contentItems[g].config[this._dimension]=f);this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged")},removeChild:function(a,c){var g,h,d=a.config[this._dimension],e=b.utils.indexOf(a,this.contentItems),f=Math.max(e-1,0);if(e===-1)throw new Error("Can't remove child. ContentItem is not child of this Row or Column");for(this._splitter[f]&&(this._splitter[f]._$destroy(),this._splitter.splice(f,1)),g=0;g<this.contentItems.length;g++)this.contentItems[g]!==a&&(this.contentItems[g].config[this._dimension]+=d/(this.contentItems.length-1));b.items.AbstractContentItem.prototype.removeChild.call(this,a,c),1===this.contentItems.length&&this.config.isClosable===!0?(h=this.contentItems[0],this.contentItems=[],this.parent.replaceChild(this,h,!0)):(this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged"))},replaceChild:function(a,c){var d=a.config[this._dimension];b.items.AbstractContentItem.prototype.replaceChild.call(this,a,c),c.config[this._dimension]=d,this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged")},setSize:function(){this.contentItems.length>0&&(this._calculateRelativeSizes(),this._setAbsoluteSizes()),this.emitBubblingEvent("stateChanged"),this.emit("resize")},_$init:function(){if(this.isInitialised!==!0){var a;for(b.items.AbstractContentItem.prototype._$init.call(this),a=0;a<this.contentItems.length-1;a++)this.contentItems[a].element.after(this._createSplitter(a).element)}},_setAbsoluteSizes:function(){var a,f,g,b=(this.contentItems.length-1)*this._splitterSize,c=this.element.width(),d=this.element.height(),e=0,h=[];for(this._isColumn?d-=b:c-=b,a=0;a<this.contentItems.length;a++)g=this._isColumn?Math.floor(d*(this.contentItems[a].config.height/100)):Math.floor(c*(this.contentItems[a].config.width/100)),e+=g,h.push(g);for(f=Math.floor((this._isColumn?d:c)-e),a=0;a<this.contentItems.length;a++)f-a>0&&h[a]++,this._isColumn?(this.contentItems[a].element.width(c),this.contentItems[a].element.height(h[a])):(this.contentItems[a].element.width(h[a]),this.contentItems[a].element.height(d))},_calculateRelativeSizes:function(){var a,b=0,c=[],d=this._isColumn?"height":"width";for(a=0;a<this.contentItems.length;a++)void 0!==this.contentItems[a].config[d]?b+=this.contentItems[a].config[d]:c.push(this.contentItems[a]);if(100!==Math.round(b))if(Math.round(b)<100&&c.length>0)for(a=0;a<c.length;a++)c[a].config[d]=(100-b)/c.length;else{if(Math.round(b)>100)for(a=0;a<c.length;a++)c[a].config[d]=50,b+=50;for(a=0;a<this.contentItems.length;a++)this.contentItems[a].config[d]=this.contentItems[a].config[d]/b*100}},_createSplitter:function(a){var c;return c=new b.controls.Splitter(this._isColumn,this._splitterSize),c.on("drag",b.utils.fnBind(this._onSplitterDrag,this,[c]),this),c.on("dragStop",b.utils.fnBind(this._onSplitterDragStop,this,[c]),this),c.on("dragStart",b.utils.fnBind(this._onSplitterDragStart,this,[c]),this),this._splitter.splice(a,0,c),c},_getItemsForSplitter:function(a){var c=b.utils.indexOf(a,this._splitter);return{before:this.contentItems[c],after:this.contentItems[c+1]}},_getMinimumDimensions:function(a){for(var b=0,c=0,d=0;d<a.length;++d)b=Math.max(a[d].minWidth||0,b),c=Math.max(a[d].minHeight||0,c);return{horizontal:b,vertical:c}},_onSplitterDragStart:function(a){var b=this._getItemsForSplitter(a),c=this.layoutManager.config.dimensions[this._isColumn?"minItemHeight":"minItemWidth"],d=this._getMinimumDimensions(b.before.config.content),e=this._isColumn?d.vertical:d.horizontal,f=this._getMinimumDimensions(b.after.config.content),g=this._isColumn?f.vertical:f.horizontal;this._splitterPosition=0,this._splitterMinPosition=-1*(b.before.element[this._dimension]()-(e||c)),this._splitterMaxPosition=b.after.element[this._dimension]()-(g||c)},_onSplitterDrag:function(a,b,c){var d=this._isColumn?c:b;d>this._splitterMinPosition&&d<this._splitterMaxPosition&&(this._splitterPosition=d,a.element.css(this._isColumn?"top":"left",d))},_onSplitterDragStop:function(a){var c=this._getItemsForSplitter(a),d=c.before.element[this._dimension](),e=c.after.element[this._dimension](),f=(this._splitterPosition+d)/(d+e),g=c.before.config[this._dimension]+c.after.config[this._dimension];c.before.config[this._dimension]=f*g,c.after.config[this._dimension]=(1-f)*g,a.element.css({top:0,left:0}),b.utils.animFrame(b.utils.fnBind(this.callDownwards,this,["setSize"]))}}),b.items.Stack=function(c,d,e){b.items.AbstractContentItem.call(this,c,d,e),this.element=a('<div class="lm_item lm_stack"></div>'),this._activeContentItem=null,this._dropZones={},this._dropSegment=null,this._contentAreaDimensions=null,this._dropIndex=null,this.isStack=!0,this.childElementContainer=a('<div class="lm_items"></div>'),this.header=new b.controls.Header(c,this),c.config.settings.hasHeaders===!0&&this.element.append(this.header.element),this.element.append(this.childElementContainer),this._$validateClosability()},b.utils.extend(b.items.Stack,b.items.AbstractContentItem),b.utils.copy(b.items.Stack.prototype,{setSize:function(){var a,b=this.element.width(),c=this.element.height()-this.layoutManager.config.dimensions.headerHeight;for(this.childElementContainer.width(b),this.childElementContainer.height(c),a=0;a<this.contentItems.length;a++)this.contentItems[a].element.width(b).height(c);this.emit("resize"),this.emitBubblingEvent("stateChanged")},_$init:function(){var a,c;if(this.isInitialised!==!0){for(b.items.AbstractContentItem.prototype._$init.call(this),a=0;a<this.contentItems.length;a++)this.header.createTab(this.contentItems[a]),this.contentItems[a]._$hide();if(this.contentItems.length>0){if(c=this.contentItems[this.config.activeItemIndex||0],!c)throw new Error("Configured activeItemIndex out of bounds");this.setActiveContentItem(c)}}},setActiveContentItem:function(a){if(b.utils.indexOf(a,this.contentItems)===-1)throw new Error("contentItem is not a child of this stack");null!==this._activeContentItem&&this._activeContentItem._$hide(),this._activeContentItem=a,this.header.setActiveContentItem(a),a._$show(),this.emit("activeContentItemChanged",a),this.emitBubblingEvent("stateChanged")},getActiveContentItem:function(){return this.header.activeContentItem},addChild:function(a,c){a=this.layoutManager._$normalizeContentItem(a,this),b.items.AbstractContentItem.prototype.addChild.call(this,a,c),this.childElementContainer.append(a.element),this.header.createTab(a,c),this.setActiveContentItem(a),this.callDownwards("setSize"),this._$validateClosability(),this.emitBubblingEvent("stateChanged")},removeChild:function(a,c){var d=b.utils.indexOf(a,this.contentItems);b.items.AbstractContentItem.prototype.removeChild.call(this,a,c),this.header.removeTab(a),this.contentItems.length>0?this.setActiveContentItem(this.contentItems[Math.max(d-1,0)]):this._activeContentItem=null,this._$validateClosability(),this.emitBubblingEvent("stateChanged")},_$validateClosability:function(){var b,c,d;for(b=this.header._isClosable(),d=0,c=this.contentItems.length;d<c&&b;d++)b=this.contentItems[d].config.isClosable;this.header._$setClosable(b)},_$destroy:function(){b.items.AbstractContentItem.prototype._$destroy.call(this),this.header._$destroy()},_$onDrop:function(a){if("header"===this._dropSegment)return this._resetHeaderDropZone(),void this.addChild(a,this._dropIndex);if("body"===this._dropSegment)return void this.addChild(a);var i,j,k,c="top"===this._dropSegment||"bottom"===this._dropSegment,d="left"===this._dropSegment||"right"===this._dropSegment,e="top"===this._dropSegment||"left"===this._dropSegment,f=c&&this.parent.isColumn||d&&this.parent.isRow,g=c?"column":"row",h=c?"height":"width";a.isComponent&&(j=this.layoutManager.createContentItem({type:"stack"},this),j._$init(),j.addChild(a),a=j),f?(i=b.utils.indexOf(this,this.parent.contentItems),this.parent.addChild(a,e?i:i+1,!0),this.config[h]*=.5,a.config[h]=this.config[h],this.parent.callDownwards("setSize")):(g=c?"column":"row",k=this.layoutManager.createContentItem({type:g},this),this.parent.replaceChild(this,k),k.addChild(a,e?0:void 0,!0),k.addChild(this,e?void 0:0,!0),this.config[h]=50,a.config[h]=50,k.callDownwards("setSize"))},_$highlightDropZone:function(a,b){var c,d;for(c in this._contentAreaDimensions)if(d=this._contentAreaDimensions[c].hoverArea,d.x1<a&&d.x2>a&&d.y1<b&&d.y2>b)return void("header"===c?(this._dropSegment="header",this._highlightHeaderDropZone(a)):(this._resetHeaderDropZone(),this._highlightBodyDropZone(c)))},_$getArea:function(){if(this.element.is(":visible")===!1)return null;var a=b.items.AbstractContentItem.prototype._$getArea,c=a.call(this,this.header.element),d=a.call(this,this.childElementContainer),e=d.x2-d.x1,f=d.y2-d.y1;return this._contentAreaDimensions={header:{hoverArea:{x1:c.x1,y1:c.y1,x2:c.x2,y2:c.y2},highlightArea:{x1:c.x1,y1:c.y1,x2:c.x2,y2:c.y2}}},this._activeContentItem&&this._activeContentItem.isComponent===!1?c:0===this.contentItems.length?(this._contentAreaDimensions.body={hoverArea:{x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2},highlightArea:{x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2}},a.call(this,this.element)):(this._contentAreaDimensions.left={hoverArea:{x1:d.x1,y1:d.y1,x2:d.x1+.25*e,y2:d.y2},highlightArea:{x1:d.x1,y1:d.y1,x2:d.x1+.5*e,y2:d.y2}},this._contentAreaDimensions.top={hoverArea:{x1:d.x1+.25*e,y1:d.y1,x2:d.x1+.75*e,y2:d.y1+.5*f},highlightArea:{x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y1+.5*f}},this._contentAreaDimensions.right={hoverArea:{x1:d.x1+.75*e,y1:d.y1,x2:d.x2,y2:d.y2},highlightArea:{x1:d.x1+.5*e,y1:d.y1,x2:d.x2,y2:d.y2}},this._contentAreaDimensions.bottom={hoverArea:{x1:d.x1+.25*e,y1:d.y1+.5*f,x2:d.x1+.75*e,y2:d.y2},highlightArea:{x1:d.x1,y1:d.y1+.5*f,x2:d.x2,y2:d.y2}},a.call(this,this.element))},_highlightHeaderDropZone:function(a){var b,c,f,g,h,i,j,k,l,d=this.header.tabs.length,e=!1;if(0===d)return j=this.header.element.offset(),void this.layoutManager.dropTargetIndicator.highlightArea({x1:j.left,x2:j.left+100,y1:j.top+this.header.element.height()-20,y2:j.top+this.header.element.height()});for(b=0;b<d;b++)if(c=this.header.tabs[b].element,h=c.offset(),g=h.left,f=h.top,k=c.width(),a>g&&a<g+k){e=!0;break}e===!1&&a<g||(l=g+k/2,a<l?(this._dropIndex=b,c.before(this.layoutManager.tabDropPlaceholder)):(this._dropIndex=Math.min(b+1,d),c.after(this.layoutManager.tabDropPlaceholder)),i=this.layoutManager.tabDropPlaceholder.offset().left,this.layoutManager.dropTargetIndicator.highlightArea({x1:i,x2:i+this.layoutManager.tabDropPlaceholder.width(),y1:f,y2:f+c.innerHeight()}))},_resetHeaderDropZone:function(){this.layoutManager.tabDropPlaceholder.remove()},_highlightBodyDropZone:function(a){var b=this._contentAreaDimensions[a].highlightArea;this.layoutManager.dropTargetIndicator.highlightArea(b),this._dropSegment=a}}),b.utils.BubblingEvent=function(a,b){this.name=a,this.origin=b,this.isPropagationStopped=!1},b.utils.BubblingEvent.prototype.stopPropagation=function(){this.isPropagationStopped=!0},b.utils.ConfigMinifier=function(){this._keys=["settings","hasHeaders","constrainDragToContainer","selectionEnabled","dimensions","borderWidth","minItemHeight","minItemWidth","headerHeight","dragProxyWidth","dragProxyHeight","labels","close","maximise","minimise","popout","content","componentName","componentState","id","width","type","height","isClosable","title","popoutWholeStack","openPopouts","parentId","activeItemIndex","reorderEnabled"],this._values=[!0,!1,"row","column","stack","component","close","maximise","minimise","open in new window"]},b.utils.copy(b.utils.ConfigMinifier.prototype,{minifyConfig:function(a){var b={};return this._nextLevel(a,b,"_min"),b},unminifyConfig:function(a){var b={};return this._nextLevel(a,b,"_max"),b},_nextLevel:function(a,b,c){var d,e;for(d in a)a instanceof Array&&(d=parseInt(d,10)),a.hasOwnProperty(d)&&(e=this[c](d,this._keys),"object"==typeof a[d]?(b[e]=a[d]instanceof Array?[]:{},this._nextLevel(a[d],b[e],c)):b[e]=this[c](a[d],this._values))},_min:function(a,c){if("string"==typeof a&&1===a.length)return"___"+a;var d=b.utils.indexOf(a,c);return d===-1?a:d.toString(36)},_max:function(a,b){return"string"==typeof a&&1===a.length?b[parseInt(a,36)]:"string"==typeof a&&"___"===a.substr(0,3)?a[3]:a}}),b.utils.EventHub=function(c){b.utils.EventEmitter.call(this),this._layoutManager=c,this._dontPropagateToParent=null,this._childEventSource=null,this.on(b.utils.EventEmitter.ALL_EVENT,b.utils.fnBind(this._onEventFromThis,this)),this._boundOnEventFromChild=b.utils.fnBind(this._onEventFromChild,this),a(window).on("gl_child_event",this._boundOnEventFromChild)},b.utils.EventHub.prototype._onEventFromThis=function(){var a=Array.prototype.slice.call(arguments);this._layoutManager.isSubWindow&&a[0]!==this._dontPropagateToParent&&this._propagateToParent(a),this._propagateToChildren(a),this._dontPropagateToParent=null,this._childEventSource=null},b.utils.EventHub.prototype._$onEventFromParent=function(a){this._dontPropagateToParent=a[0],this.emit.apply(this,a)},b.utils.EventHub.prototype._onEventFromChild=function(a){this._childEventSource=a.originalEvent.__gl,this.emit.apply(this,a.originalEvent.__glArgs)},b.utils.EventHub.prototype._propagateToParent=function(a){var b,c="gl_child_event";document.createEvent?(b=window.opener.document.createEvent("HTMLEvents"),b.initEvent(c,!0,!0)):(b=window.opener.document.createEventObject(),b.eventType=c),b.eventName=c,b.__glArgs=a,b.__gl=this._layoutManager,document.createEvent?window.opener.dispatchEvent(b):window.opener.fireEvent("on"+b.eventType,b)},b.utils.EventHub.prototype._propagateToChildren=function(a){var b,c;for(c=0;c<this._layoutManager.openPopouts.length;c++)b=this._layoutManager.openPopouts[c].getGlInstance(),b&&b!==this._childEventSource&&b.eventHub._$onEventFromParent(a)},b.utils.EventHub.prototype.destroy=function(){a(window).off("gl_child_event",this._boundOnEventFromChild)},b.utils.ReactComponentHandler=function(a,b){this._reactComponent=null,this._originalComponentWillUpdate=null,this._container=a,this._initialState=b,this._reactClass=this._getReactClass(),this._container.on("open",this._render,this),this._container.on("destroy",this._destroy,this)},b.utils.copy(b.utils.ReactComponentHandler.prototype,{_render:function(){this._reactComponent=ReactDOM.render(this._getReactComponent(),this._container.getElement()[0]),this._originalComponentWillUpdate=this._reactComponent.componentWillUpdate||function(){},this._reactComponent.componentWillUpdate=this._onUpdate.bind(this),this._container.getState()&&this._reactComponent.setState(this._container.getState())},_destroy:function(){ReactDOM.unmountComponentAtNode(this._container.getElement()[0]),this._container.off("open",this._render,this),this._container.off("destroy",this._destroy,this)},_onUpdate:function(a,b){this._container.setState(b),this._originalComponentWillUpdate.call(this._reactComponent,a,b)},_getReactClass:function(){var b,a=this._container._config.component;if(!a)throw new Error("No react component name. type: react-component needs a field `component`");if(b=this._container.layoutManager.getComponent(a),!b)throw new Error('React component "'+a+'" not found. Please register all components with GoldenLayout using `registerComponent(name, component)`');return b},_getReactComponent:function(){var b={glEventHub:this._container.layoutManager.eventHub,glContainer:this._container},c=a.extend(b,this._container._config.props);return React.createElement(this._reactClass,c)}})}(window.$);